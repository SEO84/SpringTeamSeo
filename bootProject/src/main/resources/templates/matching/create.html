<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>매칭방 생성</title>
    <!-- 커스텀 CSS -->
    <link rel="stylesheet" th:href="@{/css/create.css}">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
<div class="container my-5 create-form-container">
    <form th:action="@{/matching/create}" th:object="${matchingRoomDTO}" method="post" enctype="multipart/form-data">
        <!-- 이미지 업로드 섹션 -->
        <div class="form-group">
            <label for="imageFile">이미지</label>

            <!-- 파일 선택 -->
            <div class="file-input-container mb-3">
                <input type="text" id="fileName" class="form-control" readonly placeholder="파일을 선택하세요">
                <button type="button" class="btn btn-dark mt-2" onclick="document.getElementById('imageFile').click()">찾기</button>
                <input type="file" name="imageFile" id="imageFile" class="form-control-file" onchange="previewImage(event)" style="display: none;">
            </div>

            <!-- 미리보기 섹션 -->
            <div class="image-preview" id="imagePreviewContainer">
                <img id="imagePreview" src="@{/img/thumbnail-default.svg}" alt="이미지 미리보기">
            </div>
        </div>


        <!-- 모임 장소 -->
        <div class="form-group">
            <label for="place">모임장소</label>
            <div class="input-group">
                <input type="text" th:field="*{place}" id="place" class="form-control" placeholder="주소 입력">
                <button type="button" class="btn btn-dark">주소찾기</button>
            </div>
        </div>

        <!-- 모임 날짜 -->
        <div class="form-group">
            <label for="meetingDate">모임날짜</label>
            <input type="date" th:field="*{meetingDate}" id="meetingDate" class="form-control">
        </div>

        <!-- 모임 시간 & 모임 인원 -->
        <div class="form-row">
            <div class="form-group col-md-6">
                <label for="meetingTime">모임시간</label>
                <input type="time" th:field="*{meetingTime}" id="meetingTime" class="form-control">
            </div>
            <div class="form-group col-md-6">
                <label for="maxParticipants">모임인원</label>
                <input type="number" th:field="*{maxParticipants}" id="maxParticipants" class="form-control" min="1" max="100">
            </div>
        </div>

        <!-- 반려동물 선택 -->
        <div class="form-group">
            <label>반려동물</label>
            <div class="pets-selection">
                <div th:each="pet : ${userPets}" class="pet-container">
                    <input type="checkbox" th:id="'pet-' + ${pet.petId}" th:value="${pet.petId}" th:field="*{petIds}">
                    <label th:for="'pet-' + ${pet.petId}">
                        <span th:text="${pet.name}">펫 이름</span>
                    </label>
                </div>
            </div>
        </div>

        <!-- 제목 -->
        <div class="form-group">
            <label for="title">제목</label>
            <input type="text" th:field="*{title}" id="title" class="form-control">
        </div>

        <!-- 내용 -->
        <div class="form-group">
            <label for="description">내용 및 규칙</label>
            <textarea th:field="*{description}" id="description" class="form-control" rows="5" placeholder="내용 및 규칙을 적어주세요"></textarea>
        </div>

        <!-- 하단 버튼 -->
        <div class="form-buttons">
            <a th:href="@{/matching/list}" class="btn btn-secondary">취소</a>
            <button type="submit" class="btn btn-dark">완료</button>
        </div>
    </form>
</div>

<script th:src="@{/js/create.js}"></script>
<script>
    // 이미지 미리보기 및 파일명 업데이트
    function previewImage(event) {
        const imagePreview = document.getElementById('imagePreview');
        imagePreview.src = URL.createObjectURL(event.target.files[0]);
        imagePreview.style.display = 'block';
    }

    function updateFileName(event) {
        const fileNameInput = document.getElementById('fileName');
        const file = event.target.files[0];
        fileNameInput.value = file ? file.name : '';
    }
</script>
</body>
</html>
